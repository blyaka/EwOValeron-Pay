{% extends '_base.html' %}
{% load static %}


{% block styles %}
<link rel="stylesheet" href="{% static 'css/pages/catalog.css' %}">
{% endblock styles %}

{% block content %}

<main class="catalog-main">
  <section class="cat-head">
    <div class="container">
      <h1 class="section-title" style="margin-bottom:16px">–ö–∞—Ç–∞–ª–æ–≥</h1>
      <div class="cat-row" id="catRow">
        <input type="text" id="searchInput" class="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Ç–æ–≤–∞—Ä–∞–º...">
      </div>
    </div>
  </section>

  <section class="catalog-grid">
    <div class="container grid" id="grid">
      {% for product in products %}

      <article class="p-card">
        <div class="p-media" aria-hidden="true">
          <img src="{{product.poster.url}}" alt="{{product.name}}" />
        </div>
        <div class="p-body">
          <h3 class="p-title">{{product.name}}</h3>
          <p class="p-desc">{{product.description}}</p>
          <div class="p-foot">
            <div class="p-price">{{product.price}}</div>
            <button class="btn p-buy">–ö—É–ø–∏—Ç—å</button>
          </div>
        </div>
      </article>

      {% endfor %}

    </div>
    <div id="noResults" class="no-results" style="display:none">
      –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ üòï
    </div>
  </section>
</main>

<script>
  const searchInput = document.getElementById('searchInput');
  const cards = document.querySelectorAll('.p-card');
  const noResults = document.getElementById('noResults');

  searchInput.addEventListener('input', () => {
    const query = searchInput.value.toLowerCase();
    let visibleCount = 0;

    cards.forEach(card => {
      const title = card.querySelector('.p-title').textContent.toLowerCase();
      const desc = card.querySelector('.p-desc').textContent.toLowerCase();

      if (title.includes(query) || desc.includes(query)) {
        card.style.display = '';
        visibleCount++;
      } else {
        card.style.display = 'none';
      }
    });

    noResults.style.display = visibleCount === 0 ? 'block' : 'none';
  });

  document.querySelectorAll('.p-buy').forEach(b => {
    b.addEventListener('click', () => alert('–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏ ‚Äî —Å–∫–æ—Ä–æ.'));
  });
</script>
{% endblock content %}